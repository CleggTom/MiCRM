<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Usage · MiCRM.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://cleggtom.github.io/MiCRM.jl/pages/overview/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MiCRM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MiCRM.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Basic Usage</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Generating-Community-Parameters"><span>Generating Community Parameters</span></a></li><li><a class="tocitem" href="#Defining-System-Dynamics"><span>Defining System Dynamics</span></a></li><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Parameters</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../parameters/parameters/">Overview</a></li><li><a class="tocitem" href="../parameters/community_generation/">Parameter generators</a></li><li><a class="tocitem" href="../parameters/coalescence/">Coalescence</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Simulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simulations/simulations/">Overview</a></li><li><a class="tocitem" href="../simulations/custom_dynamics/">Custom Dynamics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../analysis/analysis/">Overview</a></li><li><a class="tocitem" href="../analysis/GLV/">Effective Lottka Volterra</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Basic Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cleggtom/MiCRM.jl/blob/main/docs/src/pages/overview.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This page will guide you through simulating microbial consumer resource models (MiCRMs) including community parameter generation. In general simulation of microbial communities in <code>MiCRM.jl</code> are done in three steps:</p><ol><li>Generate community parameters</li><li>Define system dynamics</li><li>Simulate system</li></ol><p>We will walkthrough the simulation of the basic MiCRM model given by the set of equations:</p><p class="math-container">\[\begin{aligned}
    \frac{dC_i}{dt} &amp;= \sum_{\alpha = 0}^{M} C_i R_{\alpha} u_{i\alpha}  (1 - \lambda_{\alpha}) - C_i m_i \\
    \frac{dR_\alpha}{dt} &amp;= \rho_{\alpha} - R_{\alpha} \omega_{\alpha} - \sum_{i = 0}^{N} C_i R_{\alpha} u_{i\alpha} + \sum_{i = 0}^{N} \sum_{\beta = 0}^{M} C_i R_{\beta} u_{i \beta} l_{\beta \alpha}
\end{aligned}\]</p><p>with parameters:</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Description</th><th style="text-align: right">Key</th></tr><tr><td style="text-align: right"><span>$C_i$</span></td><td style="text-align: right">Biomass of the <span>$i$</span>th consumer</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$R_{\alpha}$</span></td><td style="text-align: right">Mass of the <span>$\alpha$</span>th resource</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right"><span>$N$</span></td><td style="text-align: right">Number of consumer populations</td><td style="text-align: right"><code>N</code></td></tr><tr><td style="text-align: right"><span>$M$</span></td><td style="text-align: right">Number of resources</td><td style="text-align: right"><code>M</code></td></tr><tr><td style="text-align: right"><span>$u_{i \alpha}$</span></td><td style="text-align: right">Uptake rate of the <span>$\alpha$</span>th resource  by the <code>i</code>th consumer</td><td style="text-align: right"><code>u</code></td></tr><tr><td style="text-align: right"><span>$m_i$</span></td><td style="text-align: right">Loss term for the <span>$i$</span>th consumer</td><td style="text-align: right"><code>m</code></td></tr><tr><td style="text-align: right"><span>$\rho_{\alpha}$</span></td><td style="text-align: right">Inflow rate for the <span>$\alpha$</span>th resource</td><td style="text-align: right"><code>ρ</code></td></tr><tr><td style="text-align: right"><span>$\omega_{\alpha}$</span></td><td style="text-align: right">Outflow term for the <span>$j$</span>resource</td><td style="text-align: right"><code>ω</code></td></tr><tr><td style="text-align: right"><span>$l_{\alpha \beta}$</span></td><td style="text-align: right">Proportion of uptake of the <span>$\alpha$</span>th resource leaked to the <span>$\beta$</span>th resource.</td><td style="text-align: right"><code>l</code></td></tr><tr><td style="text-align: right"><span>$\lambda_{\alpha}$</span></td><td style="text-align: right">Total proportion of the <span>$\alpha$</span>th resource leaked, same as <span>$\sum_{\beta} l_{\alpha,\beta}$</span></td><td style="text-align: right"><code>λ</code></td></tr></table><h2 id="Generating-Community-Parameters"><a class="docs-heading-anchor" href="#Generating-Community-Parameters">Generating Community Parameters</a><a id="Generating-Community-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-Community-Parameters" title="Permalink"></a></h2><p>The first step of any simulation is to generate a set of parameters for a given microbial community. <code>MiCRM.jl</code> stores all parameters in <code>NamedTuples</code> which are immutable (cannot be altered once created) making them fast and (as the name would suggest) indexable by name. This makes them easy to use in the derivative function. In this example we will consider a simple unstructured community where uptake and leakage values are randomly drawn from a dirchlet distribution and all other parameters are set to 1:</p><pre><code class="nohighlight hljs">    using Distributions

    #set system size and leakage
    N,M,leakage = 10,10,0.3

    #uptake
    du = Distributions.Dirichlet(N,1.0)
    u = copy(rand(du, M)&#39;)

    #cost term
    m = ones(N)

    #inflow + outflow
    ρ,ω = ones(M),ones(M)

    #leakage
    l = copy(rand(du,M)&#39; .* leakage)

    param = (N = N, M = M, u = u, m = m, ρ = ρ, ω = ω, l = l, λ = leakage)</code></pre><p>In practice it is much more convenient to wrap this in a function. In <code>MiCRM.jl</code> this is all wrapped in the <code>generate_params</code> function. This function  takes various functions as arguments which define how the parameters in the model are generated  (see XXX for more detail). By default <code>generate_params</code> creates communities with random parameters as above. The code to generate a random community thus becomes:</p><pre><code class="nohighlight hljs">    using MiCRM

    #set system size and leakage
    N,M,leakage = 10,10,0.3

    #generate community parameters
    param = MiCRM.Parameters.generate_params(N,M,leakage)</code></pre><p>You can of course define your own functions to generate communities (see XXX for more detail). </p><h2 id="Defining-System-Dynamics"><a class="docs-heading-anchor" href="#Defining-System-Dynamics">Defining System Dynamics</a><a id="Defining-System-Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-System-Dynamics" title="Permalink"></a></h2><p>Once we have a set of parameters the next step is to define the dynamics of the community we want to simulate. <code>MiCRM.jl</code> allows the user to specify the  dynamics of the system they wish to simulate by passing custom functions to the <code>MiCRM.Simulations.dx!</code> function. This process is explained in more detail XXX but briefly the user can specify dynamics depending on the parameters created in the previous step as well as additional state variables to represent external drivers such as temperature. In this example we will use the default dynamics as described above and so we can just use the <code>MiCRM.Simulations.dx!</code> out of the box. </p><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><p>Once we have the parameters and the derivative equation we are ready to simulate the system and integrate through time. <code>MiCRM.jl</code> relies heavily on the brilliant <code>DifferentialEquations.jl</code> to do the numerical integration and it is worth having a look at the docs to get an idea of what is going on under the hood in your simulations. The simulation procedure is fairly straightforward and just requires that we first create an <code>ODEProblem</code> object which defines the problem for the ODE solver and then solve it with the aptly named <code>solve</code> function. <code>MiCRM.jl</code> imports a lightweight version of the <code>DifferentialEquations.jl</code> package to use so these functions are available when we run <code>using MiCRM</code>. To define the <code>ODEProblem</code> we need to specify the initial state of the system as well as the timespan we want to simulate over:</p><pre><code class="nohighlight hljs">    #inital state
    x0 = ones(N+M)
    #time span
    tspan = (0.0, 10.0)

    #define problem
    prob = ODEProblem(MiCRM.Simulations.dx!, x0, tspan, param)
    sol = solve(prob, Tsit5())</code></pre><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><p>Once the simulation is done </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../parameters/parameters/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 3 November 2022 10:21">Thursday 3 November 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
